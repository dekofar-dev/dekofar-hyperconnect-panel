<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!--begin::Card-->
      <div class="card shadow-lg border-0">
        <!--begin::Header-->
        <div class="card-header align-items-center">
          <div class="card-title d-flex align-items-center gap-3">
            <h3 class="fw-bold mb-0">ðŸ“¦ Takip Kodu ile Kargo Sorgulama</h3>
          </div>
        </div>
        <!--end::Header-->

        <!--begin::Body-->
        <div class="card-body p-lg-6">
          <!-- Input -->
          <div class="mb-3">
            <label class="form-label fw-bold">GÃ¶nderi Takip NumarasÄ±</label>
            <input
              type="text"
              [(ngModel)]="shipmentId"
              class="form-control form-control-lg"
              placeholder="Takip numarasÄ± giriniz"
            />
          </div>

          <button
            class="btn btn-success btn-lg w-100"
            (click)="search()"
            [disabled]="loading"
          >
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            ðŸš€ Sorgula
          </button>

          <!-- Hata MesajÄ± -->
          <div *ngIf="error" class="alert alert-danger mt-3 d-flex align-items-center">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <div>{{ error }}</div>
          </div>

          <!-- Son Durum -->
          <div *ngIf="status" class="mt-4">
            <h4 class="fw-bold text-primary">ðŸ“¦ Son Durum</h4>
            <div class="p-3 border rounded bg-light">
              <p>
                <strong>Durum:</strong>
                <span class="badge bg-info text-dark">{{
                  status?.shipmentStatusExplanation
                }}</span>
              </p>
              <p><strong>Takip No:</strong> {{ status?.shipmentId }}</p>
              <p><strong>SipariÅŸ No:</strong> {{ status?.referenceId }}</p>
              <p><strong>Tarih:</strong> {{ status?.statusDateTime }}</p>
            </div>
          </div>

          <!-- Hareket GeÃ§miÅŸi -->
          <div *ngIf="tracks && tracks.length > 0" class="mt-4">
            <h4 class="fw-bold text-success">ðŸšš Hareket GeÃ§miÅŸi</h4>
            <div class="table-responsive position-relative">
              <table class="table table-hover align-middle">
                <thead class="table-dark">
                  <tr>
                    <th>Tarih</th>
                    <th>Durum</th>
                    <th>Lokasyon</th>
                    <th>AlÄ±cÄ±</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let t of tracks">
                    <td>{{ t.eventDateTime }}</td>
                    <td>
                      <span class="badge bg-primary">{{ t.eventStatus }}</span>
                    </td>
                    <td>
                      {{ t.location }} <br />
                      <small class="text-muted">{{ t.locationAddress }}</small>
                    </td>
                    <td>{{ t.deliveryTo }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- GÃ¶nderi DetaylarÄ± -->
          <div *ngIf="detail" class="mt-4">
            <h4 class="fw-bold text-dark">ðŸ“‘ GÃ¶nderi DetaylarÄ±</h4>
            <table class="table table-bordered table-striped">
              <tr>
                <th>Servis Tipi</th>
                <td>{{ detail.shipment?.shipmentServiceType }}</td>
              </tr>
              <tr>
                <th>Paket Tipi</th>
                <td>{{ detail.shipment?.packagingType }}</td>
              </tr>
              <tr>
                <th>Ã–deme Tipi</th>
                <td>{{ detail.shipment?.paymentType }}</td>
              </tr>
              <tr>
                <th>Teslimat Tipi</th>
                <td>{{ detail.shipment?.deliveryType }}</td>
              </tr>
              <tr>
                <th>SipariÅŸ No</th>
                <td>{{ detail.shipment?.referenceId }}</td>
              </tr>
              <tr>
                <th>GÃ¶nderi ID</th>
                <td>{{ detail.shipment?.shipmentId }}</td>
              </tr>
              <tr>
                <th>Kilo</th>
                <td>{{ detail.shipment?.totalKg }}</td>
              </tr>
              <tr>
                <th>Desi</th>
                <td>{{ detail.shipment?.totalDesi }}</td>
              </tr>
              <tr>
                <th>KDV</th>
                <td>{{ detail.shipment?.kdv }} TL</td>
              </tr>
              <tr>
                <th>Toplam</th>
                <td>{{ detail.shipment?.total }} TL</td>
              </tr>
              <tr>
                <th>Genel Toplam</th>
                <td>
                  <strong>{{ detail.shipment?.finalTotal }} TL</strong>
                </td>
              </tr>
              <tr *ngIf="detail.shipment?.isCOD === 1" class="bg-warning">
                <th>ðŸ’° KapÄ±da Ã–deme TutarÄ±</th>
                <td>
                  <span class="fs-4 fw-bold text-danger">{{
                    detail.shipment?.codAmount
                  }} TL</span>
                </td>
              </tr>
              <tr>
                <th>Ä°Ã§erik</th>
                <td>{{ detail.shipment?.content }}</td>
              </tr>
              <tr>
                <th>Tahmini Teslim</th>
                <td>{{ detail.shipment?.estimatedDeliveryDate }}</td>
              </tr>
            </table>
          </div>
        </div>
        <!--end::Body-->
      </div>
      <!--end::Card-->
    </div>
  </div>
</div>
